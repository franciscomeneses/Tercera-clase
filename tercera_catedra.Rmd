---
title: "Promedios, Intervalos de Confianza y Teor√≠a del L√≠mite Central"
subtitle: "Clase de Investigaci√≥n Cuantitativa"
author: "Francisco Meneses"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: ["xaringan_custom/xaringan-themer.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      beforeInit: "xaringan_custom/macros.js"
    number_sections: true
    seal: false
---
class: inverse, bottom, right

```{r, include=FALSE,echo=FALSE,results='hide'}
#install.packages("pagedown")
#pagedown::chrome_print("tercera_catedra.html",output="tercera_catedra.pdf")
```


```{r setup, include=FALSE, cache = FALSE}

library(dplyr)
require("knitr")
options(htmltools.dir.version = FALSE)
pacman::p_load(RefManageR)
 
```

```{r eval=FALSE, echo=FALSE}
# Correr esta l√≠nea para ejecutar
rmarkdown::render('xaringan::moon_reader')
```

<!---
About macros.js: permite escalar las im√°genes como [:scale 50%](path to image), hay si que grabar ese archivo js en el directorio.
.pull-left[<images/Conocimiento c√≠vico.png>] 
.pull-right[<images/Conocimiento c√≠vico_graf.png>]

--->

# __Tercera Clase M√©todos Cuantitativos II__
## *C√°lculo de intervalos de confianza, Teor√≠a del L√≠mite Central y prueba t*
<br>
<hr>


### Docente: Francisco Meneses


<br>

---
class: inverse, center, middle

# Retomemos: 
#¬øQu√© es la inferencia estad√≠stica?

???

Intentar inferir informaci√≥n de la poblaci√≥n a partir de datos muestrales

---

# Intervalo de Confianza (IC)

> Es un **rango** en torno al promedio muestral que contiene al verdadero promedio poblacional con cierta seguridad (confianza).  

- Ej: ‚ÄúEl promedio estimado es 500 puntos, con un IC del 95% entre 485 y 515‚Äù.  

--

- Significa que **si repiti√©ramos el estudio muchas veces**, el 95% de los intervalos obtenidos contendr√≠a el valor real.



---

## ¬øC√≥mo se ve un intervalo de confianza?

.pull-left[
```{r echo=FALSE}
library(ggplot2)
set.seed(1)
datos <- data.frame(id = c("a","b","c","d","e"),
                    media = rnorm(5, 500, 10),
                    error = runif(5, 5, 15))

ggplot(datos, aes(x = id, y = media)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = media - error, ymax = media + error), width = 0.2, linewidth = 1) +
  labs(title = "Puntaje segun Nivel Socio econ√≥mico (Fake)",
       x = "Grupo", y = "Promedio estimado") +
  theme_minimal(base_size = 16)

```
]

.pull-right[

Nota: Apreciamos 5 grupos socioecon√≥micos con distintos promedios SIMCE y distintos intervalos de confianza. Algunos intervalos son m√°s grandes que otros. Algunos grupos se solapan y otros no. El grupo c no se solapa con el grupo d

Si los intervalos no se solapan decimos que existen diferencias significativas.

**Diferencias significativas**: Diferencias que existen m√°s all√° de la muestra. 

]



---

# ¬øUtilidad de los intervalos de confianza?

- Podemos **comparar grupos**: ¬ølas diferencias son reales o por el azar de la muestra?  

- Podr√≠amos evaluar si un programa **funcion√≥**.  

- Ayuda a **comunicar resultados** con transparencia.



---
# ¬øC√≥mo se calcula el intervalo de confianza para una media?

Para una **variable continua**, como por ejemplo el puntaje en una prueba, el **intervalo de confianza del 95%** para la media se calcula como:




$$
IC = \bar{x} \pm 1.96 \cdot \frac{s}{\sqrt{n}}
$$

---

# Ejemplo:

Supongamos que en una muestra de estudiantes:

- Media = 70  
- Desviaci√≥n est√°ndar = 10  
- Tama√±o de muestra = 25

$$
IC = \bar{x} \pm z \cdot \frac{s}{\sqrt{n}}
$$



$$
IC = \{70} \pm 1.96 \cdot \frac{10}{\sqrt{25}}
$$
Margen de error: 3,92; Intervalo de confianza: 66,08 -  73,92

--

**Interpretaci√≥n:** Estamos un 95% confiados de que el promedio real en la poblaci√≥n se encuentra entre **66.08 y 73.92 puntos**.

---

# ¬øC√≥mo se calcula el intervalo de confianza para una proporci√≥n?

Para una **variable dicot√≥mica** (por ejemplo, estar de acuerdo / no estar de acuerdo), el **intervalo de confianza del 95%** para una proporci√≥n se calcula como:

$$
IC = \hat{p} \pm z \cdot \sqrt{ \frac{\hat{p}(1 - \hat{p})}{n} }
$$

Donde:

- \\( \hat{p} \\): proporci√≥n observada en la muestra  
- \\( z \\): valor cr√≠tico (1.96 para un IC del 95%)  
- \\( n \\): tama√±o de la muestra


---

# Ejemplo:

Supongamos que en una encuesta:

- 120 personas respondieron y 72 est√°n de acuerdo con una afirmaci√≥n

Entonces:

- \\( \hat{p} = \frac{72}{120} = 0.60 \\)  
- \\( n = 120 \\)  
- \\( z = 1.96 \\)


$$
IC = 0.60 \pm 1.96 \cdot \sqrt{ \frac{0.60(1 - 0.60)}{120} } 
$$

$$
IC = (0.5124,\ 0.6876)
$$

---

# ¬øQu√© intervalos queremos?

* Intervalos m√°s peque√±os son m√°s precisos y √∫tiles


# ¬øDe qu√© depende el tama√±o del intervalo? 

  * Del tama√±o de la muestra (\\( n \\))
      + Muestras m√°s grandes dan intervalos m√°s peque√±os (Precisos)
  
  * Nivel de confianza (90%, 95%, 99%, 99.9%)
  
      + A mayor nivel de confianza m√°s grande es el intervalo (Impreciso pero m√°s confiable)
      
  * Nivel de dispersi√≥n de los datos
      +  Datos m√°s dispersos implican intervalos m√°s grandes. 


---

<embed src="https://o5uemt-francisco-meneses0rivas.shinyapps.io/app_ic_parametros" style="width:800px; height: 800px;">


---

## Teor√≠a del L√≠mite Central (TLC)

Es la **base te√≥rica matem√°tica** de la est√°distica inferencial y de los Intervalos de confianza



.center[
<img src="images/intervalo-de-confianza-4.png" size="40%">
]



> ‚ÄúSi graficamos la distribuci√≥n del promedio de muchas muestras tiende a una normal al aumentar el tama√±o de la muestra, **sin importar la distribuci√≥n original**.‚Äù

---


## Teor√≠a del L√≠mite Central (TLC)

Es la **base te√≥rica matem√°tica** de la est√°distica inferencial y de los Intervalos de confianza

Desde aqu√≠ nace el n√∫mero **1.96** en la f√≥rmula para un intervalo de confianza que utiliza el 95% de confianza

Si consideramos la distribuci√≥n normal de los promedios de ‚Äúinfinitas‚Äù muestras, y dejamos +/- 1,96 desviaciones est√°ndar hacia ambos lados del par√°metro poblacional, cubrimos el 95% de los promedios obtenidos. 



.center[
<img src="images/intervalo-de-confianza-4.png" size="40%">
]


---


<embed src="https://o5uemt-francisco-meneses0rivas.shinyapps.io/taller1-c1/" style="width:800px; height: 800px;">



---

# En suma: el Teor√≠a del L√≠mite Central (TLC)

> Si sacamos una muestra al azar, es altamente improbable que el promedio de la muestra sea muy distinto al obtenido

> Podemos calcular un intervalo en torno al promedio muestral en el cual tendremos un % de confianza de que el par√°metro poblacional est√° incluido.




---

### ¬øPor qu√© es importante la Teor√≠a del L√≠mite Central?

- Es la base de la estad√≠stica inferencial

- Nos permite **estimar la incertidumbre** con herramientas conocidas.  

- Hace posible usar la **distribuci√≥n normal** (z, t, etc.) para construir intervalos y hacer pruebas.


---

# Recapitulaci√≥n

- El **promedio** resume nuestros datos, pero tiene incertidumbre debido a trabajar
con muestras.

- Los **intervalos de confianza** permiten expresar esa incertidumbre.  

- Gracias a la **Teor√≠a del L√≠mite Central**, podemos confiar en la forma en que estimamos esa incertidumbre.

---

# Pregunta para pensar ü§î

> ¬øPor qu√© es m√°s √∫til reportar un promedio **con su intervalo de confianza**, en vez del promedio solo?

--

- ¬øQu√© responder√≠as t√∫ como investigador/a?

# Actividad breve 

- Forma grupos de 2-3 personas.  
- Responde:  
  - ¬øC√≥mo explicar√≠as el concepto de intervalo de confianza a alguien que no estudia estad√≠sticas?  
  - ¬øEn qu√© tipo de decisiones crees que ser√≠a √∫til usarlo?  
  - ¬øPuedes dar un ejemplo en educaci√≥n, salud o pol√≠tica?

---

class: inverse, middle, center, slideInRight

# Prueba t

## Evaluando diferencia de medias

---

## ¬øQu√© es la prueba *t* ?

- Herramienta estad√≠stica para comparar **medias**.

- Eval√∫a si la diferencia observada entre medias de dos grupos estad√≠sticamente significativa.

- Contrasta la evidencia estad√≠stica contra $H_0$ qu√© supone que **NO** existe diferencia de medias

    + Si rechazamos $H_0$ asumimos que si existen diferencias de medias ($H_0$)

---

## ¬øCu√°ndo utilizamos la prueba t?

> Cuando queremos evaluar si la *diferencia de los promedios* de *dos* grupos es estad√≠sticamente significativa

- __Variable dependiente__: Escala de medici√≥n n√∫merica **intervalar o raz√≥n**.


- __Variable independiente__: Categ√≥rica (nominal u ordinal) con 2 categor√≠as o grupos


## Supuestos para su aplicaci√≥n

- **Normalidad** de la variable (especialmente importante para n peque√±os).


- En muestras independientes: **homogeneidad de varianzas** (prueba de Levene).

---


### F√≥rmula general


$$
t \;=\; \frac{\bar{X}_1 - \bar{X}_2}{\sqrt{\frac{s_1^2}{n_1} \;+\; \frac{s_2^2}{n_2}}}
$$

donde:  
- $\bar{X}_1$ y $\bar{X}_2$ son las medias de los dos grupos.  
- $s_1^2$ y $s_2^2$ son las varianzas muestrales.  
- $n_1$ y $n_2$ son los tama√±os de muestra.  

--


.pull-left[
<img src="images/intervalo-de-confianza-4.png" size="40%">
]

.pull-right[

* As√≠ se distribuye el valor t en una muestra grande donde no hay diferencia de medias (es decir, donde $H_0$ es real)

]
---

### Interpretaci√≥n

- **Valor p < 0.05** ‚Üí diferencia estad√≠sticamente significativa.  

- **Valor p ‚â• 0.05** ‚Üí no hay evidencia suficiente para afirmar que las medias difieran.


>  el valor p nos dice que tan improbable es haber encontrado un valor t en una muestra donde $H_0$ es real (No hay diferencias).  Si p < 0.05 descartamos $H_0$ y asumimos $H_1$

_" Si p < 0.05 Existe menos de un 5% de probabilidad de haber encontrado un valor t tan grande en una muestra donde no existe asociaci√≥n ($H_0$), por lo cual, asumimos que si existen diferencias de medias ($H_1$)"_
--

### Ejercicios

 p = 0.03 | p = 0.07 | p = 0.4  |  p = 0.006 


---

## Ejemplo r√°pido en R



```{r include=FALSE}



iris_propia = iris %>% filter(Species!="versicolor")

iris_propia$Species = iris_propia$Species %>% as.character()
options(scipen = 999)
```

.small[
```{r}
t.test(Petal.Width ~ Species, data = iris_propia) 

```
]

---

# En suma: la prueba t


*  Nos permite **inferir** si la **diferencia de medias** observada en una muestra entre **dos grupos es significativa** y, por ende, extrapolable a la poblaci√≥n


* Nos entrega un valor t, y un valor p. A partir del valor p analizamos la significaci√≥n  

* Si p< 0.05 rechazamos $H_0$ y asumimos que existe diferencia de medias ($H_1$)


_" Si p < 0.05 Existe menos de un 5% de probabilidad de haber encontrado un valor t tan grande en una muestra donde no existe asociaci√≥n ($H_0$), por lo cual, asumimos que las diferencias observadas en la muestra son significativas, es decir, existen a nivel poblacional ($H_1$)"_

---

# Ticket de salida


<img src="images/qr-ticket2.png" size="90%">




---

# Tama√±o del efecto: *d* de Cohen

**¬øPor qu√© reportarlo?**
- El valor *p* solo indica si hay evidencia de diferencia, **no su magnitud**.
- *d* de Cohen mide el tama√±o estandarizado de la diferencia de medias.
- Ejemplo de factores canserigenos: oxigeno y cigarrillo.

**F√≥rmula general (muestras independientes)**:

$d = \frac{\bar{X}_1 - \bar{X}_2}{s_p}$

donde $s_p$ es la desviaci√≥n est√°ndar combinada:

$s_p = \sqrt{ \frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2} }$

---

## Interpretaci√≥n de *d* (Cohen, 1988)

| d         | Interpretaci√≥n  | Comentario breve |
|-----------|-----------------|------------------|
| 0.20      | Peque√±o         | Diferencia ligera, poco relevante en pr√°ctica |
| 0.50      | Mediano         | Diferencia visible/moderada |
| 0.80      | Grande          | Diferencia sustancial/pr√°ctica |
|   1.00    | Muy grande      | Diferencia muy marcada |

<span class="small">*Valores umbral son orientativos; el contexto importa.*</span>

---

## Ejemplo r√°pido en R

```{r}

library(effsize)
cohen.d(Petal.Width ~ Species, data = iris_propia )
```

---

## Tipos principales

1. **Prueba *t* para una muestra**  
   - Compara la media de una muestra con un valor conocido o hipot√©tico.


2. **Prueba *t* para muestras independientes**  
   - Compara medias de **dos grupos distintos**.


3. **Prueba *t* para muestras relacionadas**  
   - Compara medias de **los mismos sujetos** en dos momentos o condiciones.

---

# En suma: debemos analizar

-  la significaci√≥n de las diferencias de medias (p)
 
-  la direcci√≥n de las diferencias de medias (t)

- la fuerza de las diferencias de medias (d)
